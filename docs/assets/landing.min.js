const GlobalTags={src:[{id:0,tag_name:"unknown"}],get tags(){return this.src},set tags(t=[]){this.src=t}};class ArticlePreviewItem extends HTMLElement{set_link(t){const e=String(this.getAttribute("aid")),a=t.querySelector("*[data-app='link']"),i=t.querySelector("*[data-app='title']");if(a.href=`./articles/${e.padStart(3,"0")}.html`,i.textContent=this.getAttribute("title"),"#"===a.href)throw new Error("Component corrupted")}set_date(t){const e=t.querySelector("*[data-app='date']");e.datetime=this.getAttribute("created"),e.textContent=new Date(this.getAttribute("created")).toLocaleString()}set_tags(t){const e=function(t="[]"){try{return JSON.parse(t)}catch(t){return[]}}(this.getAttribute("tags")),a=GlobalTags.tags,i=t.querySelector("*[data-app='tags']");i.innerHTML="",e.map((t=>{const e=a.find((e=>e.id===t))??{id:0,tag_name:"unknown"};return`<span class="item" data-app="tag-id" data-i-btn-id="${String(e.id)}">${e.tag_name}</span>`})).forEach((t=>{i.innerHTML+=t}))}set_lang(t){t.lang=this.getAttribute("language")}constructor(){super();const t=document.getElementById("article-preview-item").content;this.set_link(t),this.set_date(t),this.set_tags(t),this.set_lang(t);this.attachShadow({mode:"open"}).appendChild(t.cloneNode(!0))}}customElements.define("article-preview-item",ArticlePreviewItem);const get_article_apis=()=>{const t=(t="")=>fetch(t).then((t=>t.json()));return Promise.all([t("https://raw.githubusercontent.com/iigmir/blog-source/master/info-files/articles.json"),t("https://raw.githubusercontent.com/iigmir/blog-source/master/info-files/categories.json")])},defa=[{id:0,title:"",category_id:[0],language:"en",created_at:"1970-01-01T00:00:00Z",updated_at:"1970-01-01T00:00:00Z"}],render_articles=(t=defa)=>{t.map((t=>`<article-preview-item aid="${t.id}" title="${t.title}" tags="${JSON.stringify(t.category_id)}" language="${t.language}" created="${t.created_at}"></article-preview-item>`)).forEach((t=>{document.querySelector("#loading-appapp").innerHTML+=t}))},main=()=>{get_article_apis().then((([t,e])=>{const a=t.slice(1).slice(-6).reverse();GlobalTags.tags=e,render_articles(a)})).catch((t=>{alert(t)}))};main();