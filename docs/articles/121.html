<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>露比的銳思</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.0/milligram.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/themes/prism.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../css/index.css" />
    <link rel="shortcut icon" href="../favicon.ico" />
</head>
<body>
    <main class="articles content container">
        <h1>內頁導航</h1>
        <nav class="navigator">
            <ul class="list">
                <li class="item"><a href="../articles">Articles</a></li>
                <li class="item"><a href="../about">About Me</a></li>
                <li class="item"><a href="../tags">Tags</a></li>
            </ul>
        </nav>
        <article class="article">
            <h1>快評：修復 Module parse failed: Unexpected token ''</h1>
<p>問題很簡單。這是 Vue 2.6：</p>
<pre><code class="language-vue">&lt;template&gt;
    &lt;img v-bind:src=&quot;require(`${src}`)&quot; /&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
    computed: {
        bar() { return Math.random() &gt; 0.5; },
        src() { return `/foo/${this.bar ? &quot;bar&quot; : &quot;baz&quot;}.png`; };
    }
};
&lt;/script&gt;
</code></pre>
<p>這麼寫，然後 webpack 就報警告：</p>
<pre><code class="language-shell">Module parse failed: Unexpected token ''
File was processed with these loaders:
 * (paths)
You may need an additional loader to handle the result of these loaders.
</code></pre>
<p>答案看似困難，但其實解法出乎意料的簡單：因為 webpack loader 不知道該如何處理這種被變數化的檔案：它該用 svg loader, ico loader, 還是 png loader 呢？<br>
所以只要<strong>標明處理檔案的副檔名</strong>就可以了：</p>
<pre><code class="language-vue">&lt;template&gt;
    &lt;img v-bind:src=&quot;require(`${src}.png`)&quot; /&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
    computed: {
        bar() { return Math.random() &gt; 0.5; },
        src() { return `/foo/${this.bar ? &quot;bar&quot; : &quot;baz&quot;}`; };
    }
};
&lt;/script&gt;
</code></pre>
<p>這樣 webpack loader 就知道該用 png loader 處理你的檔案。</p>
<p>所以有兩件事：</p>
<ol>
<li><code>require()</code> 函式一定要用 <code>String</code> 包起來，這樣 webpack 才知道型別為 <code>String</code> 並處理之。</li>
<li>如果 webpack loader 裝不了或無法改 webpack 設定的話，建議在後面 <code>require()</code> 函式加上副檔名。</li>
</ol>
<p>報告完畢。</p>

        </article>
    </main>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/prism.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.20.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script type="module" src="/blog-v2/assets/article.js"></script>
</body>
</html>
